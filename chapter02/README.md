D3
======================

# 2. 정보 시각화 데이터 흐름
## 2.1 주 내용
1. 다양한 포멧의 외부 파일에서 데이터 로딩.
2. D3 스케일 사용.
3. 분석/출력을 위한 데이터 포맷.
4. 데이터 속성에 따른 그래프 그리기.
5. 그래프의 움직임과 변화.

## 2.2. D3 수행 단계
크게 보면 아래와 같다.

1. 로딩
2. 포맷
3. 측정
4. 생성
5. 갱신

### 2.2.1 로딩
XML, CSV, JSON등등 이런 포맷의 데이터를 로딩하는 것을 뜻한다.
#### 파일포맷
파일의 포맷에 따라 총 5개의 메소드를 제공한다. (02-01.Load Data.html 참고)
1. d3.text()
2. d3.xml()
3. d3.json()
4. d3.csv()
5. d3.html()

### 2.2.2 데이터 포맷팅
데이터를 로딩한후 어떻게 쓸지 데이터를 재정의 해야한다.
#### 정량적 데이터
수치화된 데이터로써 크기, 위치, 색상들을 뜻한다.
#### 범주 데이터
불연속 그룹으로 분류되는데 일반적으로 국적, 성별 처럼 문자열로 표현되며 종종 도형이나 색상으로 표현된다.
#### 위상 데이터
데이터간의 관계, 일종의 위치 데이터라고 이야기 할 수 있다.
#### 기하학적 데이터
주로 나라, 강, 도시, 도로, 지리등의 데이터.
#### 날짜/시간 데이터
날짜, 시간 같은 데이터이다 보통 ISO 8601이 가장 널리 사용된다.
#### 원시 데이터
텍스트와, 그림 같은 형태의 구조를 갖추지 않은 데이터를 말한다.
### 2.2.3 데이터 변환
여러 형식의 데이터를 처리시 데이터의 형태를 표현하기 좋은 형태로 바꾸어야 한다. 데이터는 다양한 방식으로 바꿀수 있는데 보통 캐스팅, 정규화, 그룹화, 내포등등이 있다.
#### 캐스팅 (데이터형변환)
    parstInt("100");	// 문자열 100을 숫자 100으로 변경
    parseFloat("3.14")	// 문자열 3.14를 소수 3.14로 변경
    Date.parse("Sun, 22 Dec 2015 09:00:00 GMT");	//RFC 2822형식의 문자열을 Date로 변환

#### 정규화(스케일과 규모 변경)
수치형 데이터들이 바로 화면의 위치나, 크기에 바로 대응되지 않는다. 보통 d3.scale()메서드로 화면에 표시가능하도록 정규화한다. d3.scaleLinear()를 보면 이건 하나의 범위의 값을 다른 범위의 값으로 선형대응시킨다. 스케일은 각각 배열을 인자로 받는 도메인(domain)과 레인지(range)를 메소드를 갖는다. 도메인은 값의 범위, 레인지는 변환후 값의 범위를 뜻한다. (02-02. Scale's Domain and Range.html)
#### 비닝
데이터 분류라 할수 있고 일련범위의 값을 그룹화 해준다. (02-03. scale quantile.html)
#### 내포
불연속적인 값을 공통의 속성으로 그룹화 한다.
### 2.2.4 데이터 측정
데이터를 로딩후 데이터를 측정하고 정렬해야한다. 최소/최대값, 이름, 특정 속성값의 분산 값등등을 알아야 한다. D3는 이런 값을 알아오는 기능을 제공해준다. (02-05. measurement.html)
## 2.3 데이터 바인딩
### 2.3.1 셀렉션과 바인딩
D3에서 셀렉션은 하나이상의 DOM 요소로 구성되며 연관된 데이터를 가질수 있다. (02-06. binding.html)
#### d3.selectAll()
셀렉션은 언제나 select, selectAll을 호출하면서 시작하는데 식별자에 대응하는 요소가 없을 경우 enter()가 가상의 공간을 만든다.(data쓸때), 특정 DOM요소 안에 자식요소를 생성하거나 수정할 방법을 지정하려면 셀렉션 안에서 다시 셀렉션을 생성한다. (select('body').selectAll('div') 같이) 하위 셀렉션에선 부모요소를 자동으로 생성 안한다. 그러니 부모요소를 샐랙션 하던가 append로 생성하고 시작해야 한다.
#### data()
선택한 DOM요소와 값을 바인딩한다. 각데이터는 각각의 DOM요소와 바인딩 하며 연결된 데이터는 관련 항목의 data라는 property에 저장이 된다. (02-06. binding.html)

    console.log(document.getElementsByClassName('cities')[0].__data__);

#### enter()와 exit()
데이터를 셀렉션에 바인딩시 셀렉션된 값이 많거나 데이터가 많을 수 있다. 데이터가 셀렉션된 dom보다 많으면 enter()를 호출하고 차이만큼 생성된 가상 객체를 처리 한다.만약 반대라면 exit()를 호출하고 차이만큼 생성된 가상객체를 처리한다. 만약 둘의 갯수가 같으면 enter(), exit() 둘다 호출 안한다.
#### append() insert()
append로 요소를 추가 할 수 있다 그리고 insert는 append와 다르게 요소를 추가할 위치를 지정 할수 있다.
#### attr()
요소의 property를 추가, 수정한다.
#### html()
전통적인 DOM요소의 컨텐츠는 html메서드로 설정한다.
### 2.3.2 인라인 함수로 데이터 접근
02-07. Line chart.html
### 2.3.3 스케일 통합
02-07. Line chart.html예제처럼 높이에 대응하는 값의 배열을 사용해도 괜챃긴 하다, 하지마 실제 값들은 데이터의 편차거 심해서 값을 직접 대응시키가 힘들경우가 많다. 이렬경우는 값을 정규화 한다. scaleLinear()을 사용해서 정규화 해도 너무 큰 차이라면 이상하게 표시가 된다 이럴 경우 다중 선형 스케일을 쓰는게 좋다.

    let newScale = d3.scaleLinear().domain([0, 50000]).range([0, 100]);

    // 다중선형(polylinear) 사용 : 값의 차이가 심할 경우 사용 한다.
    let polylinearScale = d3.scaleLinear().domain([0, 100, 4000, 50000]).range([0, 25, 70, 100]);

만약 500이상 응답을 받은 경우 무조건 100이라고 찍고 싶다면 다음과 같이 할 수 있다.

    let scale500 = d3.scaleLinear().domain([0, 100, 500]).range([0, 50, 100]);
    console.log(scale500(10000));	// 1287.5

기본적으로 d3의 스케일은 최소, 최대값보다 큰값이나 작은 값을 추정한다. 만약 추정하지 않으려면 clamp()를 사용해야 한다.

    // 500이상값은 무조건 100으로.. 하지만 500보다 큰값을 다 100이상값으로 반환한다.
    let newScale500 = d3.scaleLinear().domain([0, 100, 500]).range([0, 50, 100]).clamp(true);
    console.log(newScale500(10000));	// 100 

## 2.4 데이터 표현 스타일, 속성, 컨텐츠
### 2.4.1 로딩된 데이터를 시각화
1. 02-09. Cities Line chart.html (csv사용)
2. 02-10. 02-10. Tweets Line chart.html (json사용)

### 2.4.2 채널 설정
데이터 양에 따른 라인 차트나 정량된 데이터 하나만을 사용해서 시각적 표현을 할때는 여태까지 한정도면 충분하다. 지방별인구 통계, 환자 의료데이터등 정량이 아닌 다변량(multivariate)데이터 같은경우 다른 시각적 표현을 해줘야 한다. 다변량이란 데이터 포인트가 여러개인것을 뜻한다. 그러다 보니 이 여러 포인트에대해서 어떻게 데이터를 쓸지 고민해야 한다. d3에서는 도형 하나가 데이터를 시각적으로 표현하는 방법을 채널이라 한다. 02-11. Tweets degree chart.html
### 2.4.3 enter(), exit(), update()
1. enter : 데이터 갯수가 더 클때 데이터 갯수 만큼 가상의 객체를 생성. (02-12. Tweets degree chart and Enter.html)
2. exit : enter()와 반대로 엘리먼트 갯수가 클때 엘리먼트 갯수만큼의 엘리먼트의 객체를를 반환한다. 그리고 exit는 보통 셀렉션에 바인딩된 값의 배열을 통해 사용안하는 요소를 제거해서 페이지를 갱신하는 게 주 목적이다. 웃긴건 값의 배열과 매칭되는 요소들의 값이 숫자 값같은것으로 덮어 써진다. (02-12. Tweets degree chart and Enter.html)
3. update : 음 정리중.





